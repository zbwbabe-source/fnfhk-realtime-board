-- 홍콩 Section 2 누적판매 확인 (2026년 1월)
-- 25F 시즌, 의류만, 1월 1일~31일

WITH apparel_categories AS (
  SELECT '00' AS cat UNION ALL SELECT '11' UNION ALL SELECT '12' UNION ALL SELECT '13' 
  UNION ALL SELECT '14' UNION ALL SELECT '15' UNION ALL SELECT '16' UNION ALL SELECT '17' 
  UNION ALL SELECT '18' UNION ALL SELECT '19' UNION ALL SELECT '21' UNION ALL SELECT '22' 
  UNION ALL SELECT '23' UNION ALL SELECT '31' UNION ALL SELECT '33' UNION ALL SELECT '34' 
  UNION ALL SELECT '42' UNION ALL SELECT '43'
)

SELECT
  '2026-01 MTD 25F Apparel' AS CHECK_TYPE,
  MIN(SALE_DT) AS MIN_SALE_DT,
  MAX(SALE_DT) AS MAX_SALE_DT,
  COUNT(DISTINCT SALE_DT) AS DAYS_COUNT,
  SUM(TAG_SALE_AMT) AS TOTAL_SALES_HKD,
  ROUND(SUM(TAG_SALE_AMT) / 1000, 1) AS TOTAL_SALES_HKD_K,
  COUNT(DISTINCT PRDT_CD) AS PRODUCT_COUNT
FROM SAP_FNF.DW_HMD_SALE_D
WHERE (CASE WHEN BRD_CD IN ('M','I') THEN 'M' ELSE BRD_CD END) = 'M'
  AND SESN = '25F'
  AND LOCAL_SHOP_CD IN (
    -- HKMC 정상+아울렛+온라인 (warehouse 제외)
    'H01','H02','H03','H04','H05','H06','H08','H09','H10','H11','H12','H13','H14','H15','H16','H17','H18',
    'H51','H52','H53','H54',
    'HE1','HE2',
    'M01','M02','M03',
    'M51'
  )
  AND SALE_DT BETWEEN '2026-01-01' AND '2026-01-31'
  AND SUBSTR(PART_CD, 3, 2) IN (SELECT cat FROM apparel_categories);
